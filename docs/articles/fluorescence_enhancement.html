<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fluorescence enhancement vs distance in the Kretschmann configuration • planar</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/lumen/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">planar</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/plasmonics/planar">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Fluorescence enhancement vs distance in the Kretschmann configuration</h1>
                        <h4 class="author">baptiste Auguié</h4>
            
            <h4 class="date">24 February, 2017</h4>
          </div>

    
    
<div class="contents">
<p>Molecules in the vicinity of the metal surface experience a higher local field due to the excitation of SPPs, but also a possible quenching of the fluorescence emission as the non-radiative decay rate increases dramatically at short distances. Here we look at the relative contributions of the two effects as a function of distance and incident angle.</p>
<div id="setting-up" class="section level4">
<h4 class="hasAnchor">
<html><body><a href="#setting-up" class="anchor"> </a></body></html>Setting up</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## from left to right
## incident glass | metal | water
## local field enhancement for the excitation of the fluorophore

model &lt;-<span class="st"> </span>function(<span class="dt">d=</span><span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">10</span>),
                  <span class="dt">lambdaex=</span><span class="fl">632.8</span>,
                  <span class="dt">shift=</span><span class="dv">1000</span>,
                  <span class="dt">thetaex=</span><span class="kw">seq</span>(<span class="dv">50</span>,<span class="dv">55</span>)*pi/<span class="dv">180</span>,
                  <span class="dt">thetafluo=</span>thetaex,
                  <span class="dt">nPrism =</span> <span class="fl">1.766</span>,
                  <span class="dt">nWater =</span> <span class="fl">1.33</span>,
                  <span class="dt">material =</span> <span class="st">"silver"</span>,
                  <span class="dt">polarisation=</span><span class="st">"p"</span>,
                  <span class="dt">thickness =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">50</span>, <span class="dv">0</span>),
                  <span class="dt">Nquadrature1 =</span> <span class="dv">200</span>, <span class="dt">Nquadrature2 =</span> <span class="dv">500</span>,
                  <span class="dt">Nquadrature3 =</span> <span class="dv">500</span>,
                  <span class="dt">qcut =</span> <span class="ot">NULL</span>, <span class="dt">rel.err=</span> <span class="fl">1e-1</span>,
                  <span class="dt">GL=</span><span class="ot">TRUE</span>){
  
  lambdafluo &lt;-<span class="st"> </span><span class="kw">as.vector</span>(<span class="kw"><a href="../reference/raman_shift.html">raman_shift</a></span>(lambdaex, shift))
  
  epsilon.ex &lt;-<span class="st"> </span>if(material ==<span class="st"> "silver"</span>) <span class="kw">epsAg</span>(lambdaex)$epsilon else <span class="kw">epsAu</span>(lambdaex)$epsilon 
  epsilon.fluo &lt;-<span class="st"> </span>if(material ==<span class="st"> "silver"</span>) <span class="kw">epsAg</span>(lambdafluo)$epsilon else <span class="kw">epsAu</span>(lambdafluo)$epsilon 

  Mex &lt;-<span class="st"> </span><span class="kw"><a href="../reference/multilayer.html">multilayer</a></span>(<span class="dt">wavelength =</span> lambdaex, <span class="dt">angle =</span> thetaex, <span class="dt">polarisation =</span> polarisation,  
                    <span class="dt">thickness =</span> thickness, <span class="dt">d =</span> d,
                    <span class="dt">epsilon =</span> <span class="kw">list</span>(nPrism^<span class="dv">2</span>, epsilon.ex, nWater^<span class="dv">2</span>))
  
  Mfluo &lt;-<span class="st"> </span><span class="kw"><a href="../reference/multilayer.html">multilayer</a></span>(<span class="dt">wavelength =</span> lambdafluo, <span class="dt">angle =</span> thetafluo,
                      <span class="dt">polarisation =</span> polarisation,  
                      <span class="dt">thickness =</span> thickness, <span class="dt">d=</span>d,
                      <span class="dt">epsilon =</span> <span class="kw">list</span>(nPrism^<span class="dv">2</span>, epsilon.fluo, nWater^<span class="dv">2</span>))
  
  params &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">wavelength =</span> lambdafluo,
                 <span class="dt">epsilon =</span> <span class="kw">list</span>(nWater^<span class="dv">2</span>, epsilon.fluo, nPrism^<span class="dv">2</span>), <span class="co"># reversed order</span>
                 <span class="dt">thickness =</span> thickness, 
                 <span class="dt">Nquadrature1 =</span> Nquadrature1, <span class="dt">Nquadrature2 =</span> Nquadrature2,
                 <span class="dt">Nquadrature3 =</span> Nquadrature3, <span class="dt">qcut =</span> qcut, <span class="dt">rel.err=</span>rel.err,  <span class="dt">GL=</span>GL)
  
  Mtot &lt;-<span class="st">   </span><span class="kw">sapply</span>(d, function(.d){
    dl &lt;-<span class="st"> </span><span class="kw">do.call</span>(dipole, <span class="kw">c</span>(params, <span class="kw">list</span>(<span class="dt">d=</span>.d, <span class="dt">show.messages =</span> <span class="ot">FALSE</span>)))
  }, <span class="dt">simplify=</span><span class="ot">TRUE</span>)
  
  ## incident left -&gt; glass | metal | water
  last &lt;-<span class="st"> </span><span class="kw">length</span>(Mex$Mr.perp)
  Mex.perp &lt;-<span class="st">  </span>Mex$Mr.perp[[last]]
  Mfluo.perp &lt;-<span class="st">  </span>Mfluo$Mr.perp[[last]]
  Mex.par &lt;-<span class="st">  </span>Mex$Mr.par[[last]]
  Mfluo.par &lt;-<span class="st">  </span>Mfluo$Mr.par[[last]]
  
  Mtot.perp &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">unlist</span>(Mtot[<span class="st">"Mtot.perp"</span>,]),
                      <span class="dt">nrow=</span><span class="kw">NROW</span>(Mex.perp), <span class="dt">ncol=</span><span class="kw">NCOL</span>(Mex.perp), <span class="dt">byrow=</span><span class="ot">TRUE</span>)
  Mtot.par &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">unlist</span>(Mtot[<span class="st">"Mtot.par"</span>,]),
                     <span class="dt">nrow=</span><span class="kw">NROW</span>(Mex.perp), <span class="dt">ncol=</span><span class="kw">NCOL</span>(Mex.perp), <span class="dt">byrow=</span><span class="ot">TRUE</span>)
  
  d &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">d=</span><span class="kw">rep</span>(d, <span class="dt">each=</span><span class="kw">length</span>(thetaex)),
                  <span class="dt">thetaex=</span><span class="kw">rep</span>(thetaex, <span class="kw">length</span>(d)),
                  <span class="dt">Mex.perp =</span> <span class="kw">c</span>(Mex.perp),
                  <span class="dt">Mex.par =</span> <span class="kw">c</span>(Mex.par),
                  <span class="dt">Mfluo.perp =</span> <span class="kw">c</span>(Mfluo.perp),
                  <span class="dt">Mfluo.par =</span>  <span class="kw">c</span>(Mfluo.par),
                  <span class="dt">Mtot.perp =</span> <span class="kw">c</span>(Mtot.perp),
                  <span class="dt">Mtot.par =</span> <span class="kw">c</span>(Mtot.par),
                  <span class="dt">F.perp =</span> <span class="kw">c</span>(Mex.perp *<span class="st"> </span>Mfluo.perp /<span class="st"> </span>Mtot.perp),
                  <span class="dt">F.par =</span> <span class="kw">c</span>(Mex.par *<span class="st"> </span>Mfluo.par /<span class="st"> </span>Mtot.par))
  
  
  m &lt;-<span class="st"> </span><span class="kw">melt</span>(d, <span class="dt">id=</span><span class="kw">c</span>(<span class="st">"d"</span>, <span class="st">"thetaex"</span>))
  ## reorder the levels
  <span class="kw">levels</span>(m$variable) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">"Mex.perp"</span>, <span class="st">"Mex.par"</span>, <span class="st">"Mfluo.perp"</span>, <span class="st">"Mfluo.par"</span>,
                          <span class="st">"Mtot.perp"</span>, <span class="st">"Mtot.par"</span>, <span class="st">"F.perp"</span>, <span class="st">"F.par"</span>)
  m$type &lt;-<span class="st"> </span><span class="kw">factor</span>(m$variable)
  <span class="kw">levels</span>(m$type) &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="st">"Mex"</span>=<span class="st">"Mex.perp"</span>, <span class="st">"Mfluo"</span>=<span class="st">"Mfluo.perp"</span>, <span class="st">"Mtot"</span>=<span class="st">"Mtot.perp"</span>,
                         <span class="st">"Mex"</span>=<span class="st">"Mex.par"</span>, <span class="st">"Mfluo"</span>=<span class="st">"Mfluo.par"</span>, <span class="st">"Mtot"</span>=<span class="st">"Mtot.par"</span>,
                         <span class="st">"F"</span>=<span class="st">"F.perp"</span>, <span class="st">"F"</span>=<span class="st">"F.par"</span>)
  m$orientation &lt;-<span class="st"> </span><span class="kw">factor</span>(m$variable)
  <span class="kw">levels</span>(m$orientation) &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="st">"perp"</span>=<span class="st">"Mex.perp"</span>, <span class="st">"perp"</span>=<span class="st">"Mfluo.perp"</span>, <span class="st">"perp"</span>=<span class="st">"Mtot.perp"</span>,
                                <span class="st">"par"</span>=<span class="st">"Mex.par"</span>, <span class="st">"par"</span>=<span class="st">"Mfluo.par"</span>, <span class="st">"par"</span>=<span class="st">"Mtot.par"</span>,
                                <span class="st">"perp"</span>=<span class="st">"F.perp"</span>, <span class="st">"par"</span>=<span class="st">"F.par"</span>)
  
  m
}


results &lt;-<span class="st"> </span><span class="kw">model</span>(<span class="dt">d=</span><span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">50</span>, <span class="dt">length=</span><span class="dv">300</span>), <span class="dt">thetaex=</span><span class="dv">53</span>*pi/<span class="dv">180</span>,
                 <span class="dt">thetafluo=</span><span class="fl">52.3</span>*pi/<span class="dv">180</span>,
                 <span class="dt">Nquadrature1 =</span> <span class="dv">15</span>, <span class="dt">Nquadrature2 =</span> <span class="dv">135</span>,
                 <span class="dt">Nquadrature3 =</span> <span class="dv">135</span>, <span class="dt">GL=</span><span class="ot">TRUE</span>)

m &lt;-<span class="st"> </span>results
m$value[m$type ==<span class="st"> "Mtot"</span> ] &lt;-<span class="st"> </span><span class="kw">log10</span>(m$value[m$type ==<span class="st"> "Mtot"</span> ])

m$variable &lt;-<span class="st"> </span><span class="kw"><a href="../reference/modify_levels.html">modify_levels</a></span>(m$variable,
                            <span class="kw">list</span>(<span class="st">"log.Mtot.perp"</span>=<span class="st">"Mtot.perp"</span>,
                                 <span class="st">"log.Mtot.par"</span>=<span class="st">"Mtot.par"</span>))


<span class="kw">qplot</span>(d, value, <span class="dt">data=</span>m, <span class="dt">geom=</span><span class="st">"line"</span>, <span class="dt">colour=</span><span class="kw">I</span>(<span class="st">"blue"</span>)) +
<span class="st">  </span><span class="kw">facet_wrap</span>(~variable,<span class="dt">scales=</span><span class="st">"free"</span>, <span class="dt">ncol=</span><span class="dv">2</span>,<span class="dt">as.table=</span><span class="ot">FALSE</span>)+
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="st">"distance /nm"</span>, <span class="dt">expand=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="dt">lim=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="kw">max</span>(results$d)))+
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="st">""</span>) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept=</span><span class="dv">0</span>) +<span class="st"> </span><span class="kw">theme_minimal</span>() +<span class="st"> </span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.background=</span><span class="kw">element_rect</span>(<span class="dt">fill=</span><span class="ot">NA</span>))</code></pre></div>
<p><img src="fluorescenceenhancement/setup-1.png" width="672"></p>
<p>The net enhancement factor (or quenching) of the fluorescence is a relatively smooth function of the distance to the metal interface. For separations shorter than about 10 nanometres, the non-radiative decay rate enhancement dominates Mtot and a strong quenching is observed. A broad maximum is observed at a distance of about 20 nm.</p>
<p>Qualitatively similar results are obtained at other angles of incidence, but with a decrease of intensity for <span class="math inline">\(M_{ex}\)</span> and <span class="math inline">\(F = M_{ex} \cdot M_{fluo} / M_{tot}\)</span> as we depart from the optimal coupling of incident light to SPPs. The optimal angle of excitation is 53 degrees, but at the Raman-shifted wavelenth of fluorescence the emission peaks at about 52.3 degrees, which we will consider fixed for the collection (a more throrough calculation would consider the full solid angle defined by the collection optics).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">results &lt;-<span class="st"> </span><span class="kw">model</span>(<span class="dt">d=</span><span class="dv">20</span>, <span class="dt">thetaex=</span><span class="kw">seq</span>(<span class="dv">50</span>, <span class="dv">55</span>,<span class="dt">length=</span><span class="dv">300</span>)*pi/<span class="dv">180</span>,
                 <span class="dt">Nquadrature1 =</span> <span class="dv">15</span>, <span class="dt">Nquadrature2 =</span> <span class="dv">135</span>,
                 <span class="dt">Nquadrature3 =</span> <span class="dv">135</span>, <span class="dt">GL=</span><span class="ot">TRUE</span>)

m &lt;-<span class="st"> </span><span class="kw">subset</span>(results, variable %in%<span class="st"> </span><span class="kw">c</span>(<span class="st">"Mex.perp"</span>, <span class="st">"Mfluo.perp"</span>))

<span class="kw">qplot</span>(thetaex*<span class="dv">180</span>/pi, value, <span class="dt">data=</span>m, <span class="dt">geom=</span><span class="st">"line"</span>, <span class="dt">colour=</span>variable) +
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="st">"Angle /degrees"</span>, <span class="dt">expand=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))+
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="st">"M"</span>) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept=</span><span class="dv">0</span>) +<span class="st"> </span><span class="kw">theme_minimal</span>() +<span class="st"> </span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.background=</span><span class="kw">element_rect</span>(<span class="dt">fill=</span><span class="ot">NA</span>))</code></pre></div>
<p><img src="fluorescenceenhancement/angles-1.png" width="960"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">results &lt;-<span class="st"> </span><span class="kw">model</span>(<span class="dt">d=</span><span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">300</span>, <span class="dt">length=</span><span class="dv">300</span>), 
                 <span class="dt">thetaex=</span><span class="kw">seq</span>(<span class="dv">51</span>, <span class="dv">54</span>, <span class="dt">length=</span><span class="dv">300</span>)*pi/<span class="dv">180</span>,
                 <span class="dt">thetafluo =</span> <span class="fl">52.3</span>*pi/<span class="dv">180</span>,
                 <span class="dt">Nquadrature1 =</span> <span class="dv">15</span>, <span class="dt">Nquadrature2 =</span> <span class="dv">135</span>,
                 <span class="dt">Nquadrature3 =</span> <span class="dv">135</span>, <span class="dt">GL=</span><span class="ot">TRUE</span>)

m &lt;-<span class="st"> </span><span class="kw">subset</span>(results, variable ==<span class="st"> "F.perp"</span>)
<span class="kw">ggplot</span>(m, <span class="kw">aes</span>(d, thetaex*<span class="dv">180</span>/pi, <span class="dt">fill=</span>value)) +<span class="st"> </span><span class="kw">geom_raster</span>()+
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="st">"distance /nm"</span>, <span class="dt">expand=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="dt">lim=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="kw">max</span>(results$d)))+
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="st">"Incident angle /degrees"</span>, <span class="dt">expand=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">fill=</span><span class="kw">expression</span>(F==Mex %*%<span class="st"> </span>Mfluo/<span class="st"> </span>Mtot))</code></pre></div>
<p><img src="fluorescenceenhancement/angles-2.png" width="960"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Baptiste Auguie, Steven Johnson.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
