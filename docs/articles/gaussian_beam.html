<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title> • planar</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/lumen/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">planar</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/plasmonics/planar">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1></h1>
            
          </div>

    
    
<div class="contents">
<div id="near-field-profile-under-gaussian-beam-illumination" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#near-field-profile-under-gaussian-beam-illumination" class="anchor"> </a></body></html>Near-field profile under gaussian-beam illumination</h2>
<p><em>baptiste Auguié – 23 February, 2017</em></p>
<p>Using the angular spectrum decomposition of a gaussian beam in a bundle of plane waves, the near-field profile is calculated on the transmitted side of a thin metal film illuminated under total internal reflection.</p>
<p>First, we model the structure with plane-wave illumination, and find the angle corresponding to maximum field enhancement (coupling to SPPs in the Kretschmann configuration).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">struct &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">wavelength=</span><span class="fl">632.8</span>,
               <span class="dt">thickness=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">50</span>,<span class="dv">50</span>,<span class="dv">0</span>),
               <span class="dt">epsilon=</span><span class="kw">c</span>(<span class="fl">1.5</span>^<span class="dv">2</span>, <span class="kw">epsAu</span>(<span class="fl">632.8</span>)$epsilon, <span class="fl">1.1</span>^<span class="dv">2</span>, <span class="fl">1.0</span>^<span class="dv">2</span>))

## first, check the plane wave result
results &lt;-<span class="st"> </span><span class="kw"><a href="../reference/multilayer.html">multilayer</a></span>(<span class="dt">epsilon=</span><span class="kw">as.list</span>(struct$epsilon),
                      <span class="dt">wavelength=</span>struct$wavelength, <span class="dt">thickness=</span>struct$thickness, <span class="dt">d=</span><span class="dv">1</span>,
                      <span class="dt">angle=</span><span class="kw">seq</span>(<span class="dv">0</span>, pi/<span class="dv">2</span>, <span class="dt">length=</span><span class="fl">2e3</span>), <span class="dt">polarisation=</span><span class="st">'p'</span>)

enhancement &lt;-<span class="st"> </span>results$Mr.perp[[<span class="dv">2</span>]] +<span class="st"> </span>results$Mr.par[[<span class="dv">2</span>]]
maxi &lt;-<span class="st"> </span><span class="kw">max</span>(enhancement, <span class="dt">na.rm=</span>T)
spp &lt;-<span class="st"> </span>results$angle[<span class="kw">which.max</span>(enhancement)]

<span class="kw">qplot</span>(results$angle*<span class="dv">180</span>/pi, enhancement, <span class="dt">geom=</span><span class="st">"line"</span>)+
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">"incident angle /degrees"</span>, <span class="dt">y=</span><span class="kw">expression</span>(<span class="st">"|E|"</span>^<span class="dv">2</span>))</code></pre></div>
<p><img src="gaussianbeam/pw-1.png" width="672"> ## Depth profile</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">xyz &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">expand.grid</span>(<span class="dt">x=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">5000</span>, <span class="dv">10000</span>), <span class="dt">y=</span><span class="dv">0</span>, 
                             <span class="dt">z=</span><span class="kw">seq</span>(-<span class="dv">100</span>, <span class="dv">500</span>, <span class="dt">length=</span><span class="dv">100</span>)))

res &lt;-<span class="st"> </span><span class="kw"><a href="../reference/gaussian_near_field_layer.html">gaussian_near_field_layer</a></span>(xyz, <span class="dt">epsilon=</span>struct$epsilon,
                              <span class="dt">wavelength=</span>struct$wavelength, 
                              <span class="dt">thickness=</span>struct$thickness,
                              <span class="dt">w0=</span><span class="fl">5e3</span>, <span class="dt">alpha=</span>spp, <span class="dt">maxEval=</span><span class="dv">500</span>)

xyz &lt;-<span class="st"> </span><span class="kw">data.frame</span>(xyz, <span class="dt">field=</span>res)

<span class="kw">ggplot</span>(xyz, <span class="kw">aes</span>(z, field, <span class="dt">colour=</span><span class="kw">factor</span>(x)))+
<span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept=</span><span class="kw">cumsum</span>(struct$thickness), <span class="dt">linetype=</span><span class="st">"dotted"</span>) +
<span class="st">  </span><span class="kw">geom_line</span>() +<span class="st"> </span><span class="kw">scale_y_log10</span>()+
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))+
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="kw">expression</span>(<span class="st">"z /nm"</span>), <span class="dt">y=</span><span class="kw">expression</span>(<span class="kw">log</span>(<span class="st">"|E|"</span>^<span class="dv">2</span>)), 
       <span class="dt">colour=</span><span class="kw">expression</span>(<span class="st">"x /nm"</span>)) </code></pre></div>
<p><img src="gaussianbeam/depth-1.png" width="672"> We observe that the field decays exponentially away from the gold/dielectric interface (<span class="math inline">\(z&gt;50\)</span>nm) with the same characteristic distance across the beam profile. The discontinuity at <span class="math inline">\(z=100\)</span>nm occurs because of the transition between two dielectrics with slightly different refractive index (1.1 and 1.0, respectively).</p>
</div>
<div id="coupling-to-spps" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#coupling-to-spps" class="anchor"> </a></body></html>Coupling to SPPs</h2>
<p>The detrimental effect of the beam size on the field enhancement can be quite dramatic, as soon as the spread of incident angles causes the coupling to SPPs to deteriorate. Here we simulate the LFIEF for silver, with a beam waist varying from 1mm down to 2 microns.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">simulation &lt;-<span class="st"> </span>function(<span class="dt">w0=</span><span class="dv">10</span>){
  w0 &lt;-<span class="st"> </span>w0*<span class="fl">1e3</span>
  xyz &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">expand.grid</span>(<span class="dt">x=</span><span class="kw">seq</span>(-<span class="dv">5</span>*w0, <span class="dv">5</span>*w0<span class="dv">+5000</span>,<span class="dt">length=</span><span class="dv">100</span>), <span class="dt">y=</span><span class="dv">0</span>, <span class="dt">z=</span><span class="dv">51</span>))
  
  res &lt;-<span class="st"> </span><span class="kw"><a href="../reference/gaussian_near_field_ml.html">gaussian_near_field_ml</a></span>(xyz, <span class="dt">epsilon=</span>struct$epsilon,
                                <span class="dt">wavelength=</span>struct$wavelength, 
                                <span class="dt">thickness=</span>struct$thickness,
                                <span class="dt">w0=</span>w0, <span class="dt">alpha=</span>spp, <span class="dt">maxEval=</span><span class="dv">600</span>)
  
  <span class="kw">data.frame</span>(xyz, <span class="dt">field=</span>res)
}

params &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">w0=</span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">50</span>, <span class="fl">1e2</span>, <span class="dv">500</span>, <span class="fl">1e3</span>))
all &lt;-<span class="st"> </span><span class="kw">mdply</span>(params, simulation)

<span class="kw">ggplot</span>(all, <span class="kw">aes</span>(x/w0/<span class="dv">1000</span>, field, <span class="dt">group=</span>w0, <span class="dt">colour=</span><span class="kw">factor</span>(w0)))+
<span class="st">  </span><span class="kw">geom_line</span>() +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_vline</span>(<span class="kw">aes</span>(<span class="dt">xintercept=</span><span class="dv">0</span>),<span class="dt">lty=</span><span class="dv">2</span>) +
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="kw">aes</span>(<span class="dt">yintercept=</span>maxi),<span class="dt">lty=</span><span class="dv">3</span>) +
<span class="st">  </span><span class="kw">annotate</span>(<span class="st">"text"</span>, <span class="dt">label=</span><span class="st">"plane-wave"</span>, <span class="dt">y=</span>maxi, <span class="dt">x=</span>-<span class="fl">2.5</span>, <span class="dt">vjust=</span><span class="dv">1</span>, <span class="dt">fontface=</span><span class="st">"italic"</span>) +
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="kw">expression</span>(x/w[<span class="dv">0</span>]), <span class="dt">y=</span><span class="kw">expression</span>(<span class="st">"|E|"</span>^<span class="dv">2</span>), 
       <span class="dt">colour=</span><span class="kw">expression</span>(w[<span class="dv">0</span>]/mu*m)) +
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim=</span><span class="kw">c</span>(-<span class="dv">5</span>,<span class="dv">5</span>)) +<span class="st"> </span><span class="kw">theme_minimal</span>()+
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">colour=</span><span class="kw">guide_legend</span>(<span class="dt">reverse=</span><span class="ot">TRUE</span>)) +
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.background=</span><span class="kw">element_rect</span>(<span class="dt">fill=</span><span class="ot">NA</span>))</code></pre></div>
<p><img src="gaussianbeam/waist-1.png" width="672"></p>
</div>
<div id="d-map" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#d-map" class="anchor"> </a></body></html>2D map</h2>
<p>We can calculate the field at a grid of points in 2D or 3D. Here is the result for a slice at <span class="math inline">\(z=51\)</span>nm, for a beam waist of 2 microns (poor coupling).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">w0 &lt;-<span class="st"> </span><span class="dv">2000</span>
xyz &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">expand.grid</span>(<span class="dt">x=</span><span class="kw">seq</span>(-<span class="dv">3</span>*w0, <span class="dv">5</span>*w0, <span class="dt">length=</span><span class="dv">50</span>), 
                             <span class="dt">y=</span><span class="kw">seq</span>(-<span class="dv">3</span>*w0, <span class="dv">3</span>*w0, <span class="dt">length=</span><span class="dv">50</span>),
                             <span class="dt">z=</span><span class="dv">51</span>))
res &lt;-<span class="st"> </span><span class="kw"><a href="../reference/gaussian_near_field_ml.html">gaussian_near_field_ml</a></span>(xyz, <span class="dt">epsilon=</span>struct$epsilon,
                              <span class="dt">wavelength=</span>struct$wavelength, 
                              <span class="dt">thickness=</span>struct$thickness,
                              <span class="dt">w0=</span>w0, <span class="dt">alpha=</span>spp, <span class="dt">maxEval=</span><span class="dv">600</span>)

m &lt;-<span class="st"> </span><span class="kw">data.frame</span>(xyz, <span class="dt">field=</span>res)

  <span class="kw">ggplot</span>(m, <span class="kw">aes</span>(x/<span class="fl">1e3</span>, y/<span class="fl">1e3</span>, <span class="dt">fill=</span>field))+
<span class="st">  </span><span class="kw">geom_raster</span>(<span class="dt">interpolate=</span><span class="ot">TRUE</span>) +
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))+
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">expand=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) +
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="kw">expression</span>(<span class="st">"x /nm"</span>), <span class="dt">fill=</span><span class="kw">expression</span>(<span class="st">"|E|"</span>^<span class="dv">2</span>), 
       <span class="dt">y=</span><span class="kw">expression</span>(<span class="st">"y /nm"</span>)) +
<span class="st">  </span><span class="kw">coord_fixed</span>()</code></pre></div>
<p><img src="gaussianbeam/map-1.png" width="672"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#near-field-profile-under-gaussian-beam-illumination">Near-field profile under gaussian-beam illumination</a></li>
      <li><a href="#coupling-to-spps">Coupling to SPPs</a></li>
      <li><a href="#d-map">2D map</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Baptiste Auguie, Steven Johnson.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
